<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Unsolved homicides in 50 US cities</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.8.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-1.39.2/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" />
<script defer src="https://use.fontawesome.com/releases/v5.0.3/js/all.js"></script>
<script defer src="https://use.fontawesome.com/releases/v5.0.0/js/v4-shims.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Projects
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://aminyakubu.github.io/nyc-crime/index.html">NYC Crime Data Analysis</a>
    </li>
    <li>
      <a href="noaa.html">NY NOAA</a>
    </li>
    <li>
      <a href="alchohol_hypertension.html">Alcohol &amp; Hypertension</a>
    </li>
    <li>
      <a href="unsolved_homicide.html">Unsolved Homicides in 50 US Cities</a>
    </li>
    <li>
      <a href="airbnb.html">NYC AirBnB</a>
    </li>
    <li>
      <a href="whpaygap.html">White House Gender Pay Gap</a>
    </li>
    <li>
      <a href="trashwheel.html">Baltimore Inner Harbor Water Wheel</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">Curriculum vitae</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Hobbies
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="flower.html">Flowers using mathematics</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://www.linkedin.com/in/aminyakubu/">
    <span class="fa fa-linkedin fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/iamaminyakubu">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="mailto:&lt;a.yakubu@columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://github.com/aminyakubu/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Unsolved homicides in 50 US cities</h1>

</div>


The Washington Post has gathered data on homicides in 50 large U.S. cities and made the data available through GitHub. For more information on the dataset, visit The Washington Post’s GitHub page <a href="https://github.com/washingtonpost/data-homicides">here</a>
<p>
<p>In this analysis, I am going to estimate the proportion of homicides that are unsolved and the create a plot that shows the estimates and confidence intervals(CIs) for each city. I will then subsequently use <code>glm</code> function to fit a <strong>logistic regression</strong> with resolved vs unresolved as the outcome and victim race, victim sex and victim age as the predictors. I will do this within a “tidy” pipeline, making use of <code>purrr::map</code>, <code>purrr::map2</code>, <code>list columns</code> and <code>unnest</code>.</p>
<div id="description-of-dataset" class="section level4">
<h4>Description of dataset</h4>
<pre class="r"><code>hom_df = read_csv(&quot;https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv&quot;, col_names = TRUE) %&gt;% 
  mutate(city_state = str_c(city, &quot;,&quot;, &quot; &quot;, state))</code></pre>
<p>The Washington Post has collected data on 52179 criminal homicides over the past decade in 50 of the largest American cities. The dataset has 52179 observations x 13 variables. Variables include victim information like name, age, sex, and race. Geographic information collected also include city, state, longitude and latitude information. Finally the variable <code>desposition</code> records whether the homicide case was closed without any arrest, still open with no arrest and closed due to arrest.</p>
<div id="summary-statistics" class="section level5">
<h5>Summary statistics</h5>
<p>Summarizing within cities to obtain the total number of homicides and the number of unsolved homicides</p>
<pre class="r"><code>summ_df = hom_df %&gt;% 
  mutate(disposition = fct_collapse(hom_df$disposition, &quot;No arrest&quot; = c(&quot;Closed without arrest&quot;,&quot;Open/No arrest&quot;))) %&gt;% group_by(city_state) %&gt;% 
  count(disposition) %&gt;% 
  spread(key = disposition, value = n) %&gt;% 
  janitor::clean_names() %&gt;% 
  mutate(total = closed_by_arrest + no_arrest)</code></pre>
<p>For the city of Baltimore, MD, using prop.test function to estimate the proportion of homicides that are unsolved with confidence intervals</p>
<pre class="r"><code>baltimore = summ_df %&gt;% filter(city_state == &quot;Baltimore, MD&quot;)
baltimore_prop = prop.test(baltimore$no_arrest, baltimore$total) %&gt;% 
  broom::tidy() %&gt;% 
  select(estimate, conf.low, conf.high) %&gt;% 
  janitor::clean_names() %&gt;% 
  knitr::kable()

baltimore_prop</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">estimate</th>
<th align="right">conf_low</th>
<th align="right">conf_high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.6455607</td>
<td align="right">0.6275625</td>
<td align="right">0.6631599</td>
</tr>
</tbody>
</table>
<p>Now using prop.test for each of the cities in my dataset, and extracting both the proportion of unsolved homicides and the confidence interval for each.</p>
</div>
</div>
<div id="writing-a-function-to-do-prop.test-and-a-bit-of-data-cleaning" class="section level4">
<h4>Writing a function to do <code>prop.test</code> and a bit of data cleaning</h4>
<pre class="r"><code>prop_test = function(var_numerator, var_denominator) {
  
  try(prop.test(var_numerator, var_denominator) %&gt;% 
    broom::tidy() %&gt;% 
    select(estimate, conf.low, conf.high), silent = TRUE)
  
} </code></pre>
</div>
<div id="iteration" class="section level4">
<h4>Iteration</h4>
<p>Now iterating using the function above to produce the proportion and confidence intervals for each city</p>
<pre class="r"><code>unnested_ci_for_states = summ_df %&gt;% 
  mutate(estimate_ci = map2(no_arrest, total, prop_test)) %&gt;% 
  filter(city_state != &quot;Tulsa, AL&quot;) %&gt;% 
  unnest() %&gt;% 
  janitor::clean_names() %&gt;% 
  ungroup() %&gt;%  
  mutate(city_state = reorder(city_state, estimate))</code></pre>
</div>
<div id="creating-a-plot-that-shows-the-estimates-and-cis-for-each-city" class="section level4">
<h4>Creating a plot that shows the estimates and CIs for each city</h4>
<pre class="r"><code>plot = ggplot(unnested_ci_for_states, aes(x = city_state, y = estimate )) + 
  geom_point() + geom_errorbar(aes(ymin = conf_low, ymax = conf_high)) + 
  theme(axis.text.x = element_text(angle = 80, hjust = 1, size = 8)) +
  labs(
    x = &quot;City, State&quot;,
    y = &quot;Proportion (95% Confidence interval)&quot;
  )

ggplotly(plot)</code></pre>
<div id="htmlwidget-8da163afad5b225d7564" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-8da163afad5b225d7564">{"x":{"data":[{"x":[12,11,48,26,19,32,46,2,50,21,37,29,41,43,8,27,5,34,23,36,14,17,15,31,24,3,45,6,35,7,49,13,39,30,16,22,42,38,1,9,18,47,10,33,28,40,44,25,4,20],"y":[0.386243386243386,0.383350462487153,0.645560665015918,0.462264150943396,0.43375,0.504885993485342,0.612284069097889,0.299854439592431,0.735862691960253,0.445244956772334,0.530442804428044,0.481174218251436,0.541666666666667,0.58832870186582,0.365942028985507,0.46448087431694,0.347022587268994,0.507477906186268,0.449319213313162,0.511130136986301,0.408403361344538,0.414192614047791,0.412698412698413,0.490031014621179,0.453125,0.319022457067371,0.604838709677419,0.361434977578475,0.510928961748634,0.36245110821382,0.648535564853556,0.38755980861244,0.536430834213305,0.485119047619048,0.41320293398533,0.447810339150477,0.551422319474836,0.534072900158479,0.263403263403263,0.36968085106383,0.428571428571429,0.618181818181818,0.379609544468547,0.506787330316742,0.467479674796748,0.539654144305307,0.599099099099099,0.456730769230769,0.331046312178388,0.437918215613383],"text":["city_state: Albuquerque, NM<br />estimate: 0.3862434","city_state: Atlanta, GA<br />estimate: 0.3833505","city_state: Baltimore, MD<br />estimate: 0.6455607","city_state: Baton Rouge, LA<br />estimate: 0.4622642","city_state: Birmingham, AL<br />estimate: 0.4337500","city_state: Boston, MA<br />estimate: 0.5048860","city_state: Buffalo, NY<br />estimate: 0.6122841","city_state: Charlotte, NC<br />estimate: 0.2998544","city_state: Chicago, IL<br />estimate: 0.7358627","city_state: Cincinnati, OH<br />estimate: 0.4452450","city_state: Columbus, OH<br />estimate: 0.5304428","city_state: Dallas, TX<br />estimate: 0.4811742","city_state: Denver, CO<br />estimate: 0.5416667","city_state: Detroit, MI<br />estimate: 0.5883287","city_state: Durham, NC<br />estimate: 0.3659420","city_state: Fort Worth, TX<br />estimate: 0.4644809","city_state: Fresno, CA<br />estimate: 0.3470226","city_state: Houston, TX<br />estimate: 0.5074779","city_state: Indianapolis, IN<br />estimate: 0.4493192","city_state: Jacksonville, FL<br />estimate: 0.5111301","city_state: Kansas City, MO<br />estimate: 0.4084034","city_state: Las Vegas, NV<br />estimate: 0.4141926","city_state: Long Beach, CA<br />estimate: 0.4126984","city_state: Los Angeles, CA<br />estimate: 0.4900310","city_state: Louisville, KY<br />estimate: 0.4531250","city_state: Memphis, TN<br />estimate: 0.3190225","city_state: Miami, FL<br />estimate: 0.6048387","city_state: Milwaukee, wI<br />estimate: 0.3614350","city_state: Minneapolis, MN<br />estimate: 0.5109290","city_state: Nashville, TN<br />estimate: 0.3624511","city_state: New Orleans, LA<br />estimate: 0.6485356","city_state: New York, NY<br />estimate: 0.3875598","city_state: Oakland, CA<br />estimate: 0.5364308","city_state: Oklahoma City, OK<br />estimate: 0.4851190","city_state: Omaha, NE<br />estimate: 0.4132029","city_state: Philadelphia, PA<br />estimate: 0.4478103","city_state: Phoenix, AZ<br />estimate: 0.5514223","city_state: Pittsburgh, PA<br />estimate: 0.5340729","city_state: Richmond, VA<br />estimate: 0.2634033","city_state: Sacramento, CA<br />estimate: 0.3696809","city_state: San Antonio, TX<br />estimate: 0.4285714","city_state: San Bernardino, CA<br />estimate: 0.6181818","city_state: San Diego, CA<br />estimate: 0.3796095","city_state: San Francisco, CA<br />estimate: 0.5067873","city_state: Savannah, GA<br />estimate: 0.4674797","city_state: St. Louis, MO<br />estimate: 0.5396541","city_state: Stockton, CA<br />estimate: 0.5990991","city_state: Tampa, FL<br />estimate: 0.4567308","city_state: Tulsa, OK<br />estimate: 0.3310463","city_state: Washington, DC<br />estimate: 0.4379182"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[12,11,48,26,19,32,46,2,50,21,37,29,41,43,8,27,5,34,23,36,14,17,15,31,24,3,45,6,35,7,49,13,39,30,16,22,42,38,1,9,18,47,10,33,28,40,44,25,4,20],"y":[0.386243386243386,0.383350462487153,0.645560665015918,0.462264150943396,0.43375,0.504885993485342,0.612284069097889,0.299854439592431,0.735862691960253,0.445244956772334,0.530442804428044,0.481174218251436,0.541666666666667,0.58832870186582,0.365942028985507,0.46448087431694,0.347022587268994,0.507477906186268,0.449319213313162,0.511130136986301,0.408403361344538,0.414192614047791,0.412698412698413,0.490031014621179,0.453125,0.319022457067371,0.604838709677419,0.361434977578475,0.510928961748634,0.36245110821382,0.648535564853556,0.38755980861244,0.536430834213305,0.485119047619048,0.41320293398533,0.447810339150477,0.551422319474836,0.534072900158479,0.263403263403263,0.36968085106383,0.428571428571429,0.618181818181818,0.379609544468547,0.506787330316742,0.467479674796748,0.539654144305307,0.599099099099099,0.456730769230769,0.331046312178388,0.437918215613383],"text":["conf_low: 0.3372604<br />conf_high: 0.4375766<br />city_state: Albuquerque, NM<br />estimate: 0.3862434","conf_low: 0.3528119<br />conf_high: 0.4148219<br />city_state: Atlanta, GA<br />estimate: 0.3833505","conf_low: 0.6275625<br />conf_high: 0.6631599<br />city_state: Baltimore, MD<br />estimate: 0.6455607","conf_low: 0.4141987<br />conf_high: 0.5110240<br />city_state: Baton Rouge, LA<br />estimate: 0.4622642","conf_low: 0.3991889<br />conf_high: 0.4689557<br />city_state: Birmingham, AL<br />estimate: 0.4337500","conf_low: 0.4646219<br />conf_high: 0.5450881<br />city_state: Boston, MA<br />estimate: 0.5048860","conf_low: 0.5687990<br />conf_high: 0.6540879<br />city_state: Buffalo, NY<br />estimate: 0.6122841","conf_low: 0.2660820<br />conf_high: 0.3358999<br />city_state: Charlotte, NC<br />estimate: 0.2998544","conf_low: 0.7239959<br />conf_high: 0.7473998<br />city_state: Chicago, IL<br />estimate: 0.7358627","conf_low: 0.4079606<br />conf_high: 0.4831439<br />city_state: Cincinnati, OH<br />estimate: 0.4452450","conf_low: 0.5002167<br />conf_high: 0.5604506<br />city_state: Columbus, OH<br />estimate: 0.5304428","conf_low: 0.4561942<br />conf_high: 0.5062475<br />city_state: Dallas, TX<br />estimate: 0.4811742","conf_low: 0.4846098<br />conf_high: 0.5976807<br />city_state: Denver, CO<br />estimate: 0.5416667","conf_low: 0.5687903<br />conf_high: 0.6075953<br />city_state: Detroit, MI<br />estimate: 0.5883287","conf_low: 0.3095874<br />conf_high: 0.4260936<br />city_state: Durham, NC<br />estimate: 0.3659420","conf_low: 0.4222542<br />conf_high: 0.5072119<br />city_state: Fort Worth, TX<br />estimate: 0.4644809","conf_low: 0.3051013<br />conf_high: 0.3913963<br />city_state: Fresno, CA<br />estimate: 0.3470226","conf_low: 0.4892447<br />conf_high: 0.5256914<br />city_state: Houston, TX<br />estimate: 0.5074779","conf_low: 0.4223156<br />conf_high: 0.4766207<br />city_state: Indianapolis, IN<br />estimate: 0.4493192","conf_low: 0.4820460<br />conf_high: 0.5401402<br />city_state: Jacksonville, FL<br />estimate: 0.5111301","conf_low: 0.3803996<br />conf_high: 0.4370054<br />city_state: Kansas City, MO<br />estimate: 0.4084034","conf_low: 0.3881284<br />conf_high: 0.4407395<br />city_state: Las Vegas, NV<br />estimate: 0.4141926","conf_low: 0.3629026<br />conf_high: 0.4642973<br />city_state: Long Beach, CA<br />estimate: 0.4126984","conf_low: 0.4692208<br />conf_high: 0.5108754<br />city_state: Los Angeles, CA<br />estimate: 0.4900310","conf_low: 0.4120609<br />conf_high: 0.4948235<br />city_state: Louisville, KY<br />estimate: 0.4531250","conf_low: 0.2957047<br />conf_high: 0.3432691<br />city_state: Memphis, TN<br />estimate: 0.3190225","conf_low: 0.5685783<br />conf_high: 0.6400015<br />city_state: Miami, FL<br />estimate: 0.6048387","conf_low: 0.3333172<br />conf_high: 0.3905194<br />city_state: Milwaukee, wI<br />estimate: 0.3614350","conf_low: 0.4585150<br />conf_high: 0.5631099<br />city_state: Minneapolis, MN<br />estimate: 0.5109290","conf_low: 0.3285592<br />conf_high: 0.3977401<br />city_state: Nashville, TN<br />estimate: 0.3624511","conf_low: 0.6231048<br />conf_high: 0.6731615<br />city_state: New Orleans, LA<br />estimate: 0.6485356","conf_low: 0.3494421<br />conf_high: 0.4270755<br />city_state: New York, NY<br />estimate: 0.3875598","conf_low: 0.5040588<br />conf_high: 0.5685037<br />city_state: Oakland, CA<br />estimate: 0.5364308","conf_low: 0.4467861<br />conf_high: 0.5236245<br />city_state: Oklahoma City, OK<br />estimate: 0.4851190","conf_low: 0.3653146<br />conf_high: 0.4627477<br />city_state: Omaha, NE<br />estimate: 0.4132029","conf_low: 0.4300380<br />conf_high: 0.4657157<br />city_state: Philadelphia, PA<br />estimate: 0.4478103","conf_low: 0.5184825<br />conf_high: 0.5839244<br />city_state: Phoenix, AZ<br />estimate: 0.5514223","conf_low: 0.4942706<br />conf_high: 0.5734545<br />city_state: Pittsburgh, PA<br />estimate: 0.5340729","conf_low: 0.2228571<br />conf_high: 0.3082658<br />city_state: Richmond, VA<br />estimate: 0.2634033","conf_low: 0.3211559<br />conf_high: 0.4209131<br />city_state: Sacramento, CA<br />estimate: 0.3696809","conf_low: 0.3947772<br />conf_high: 0.4630331<br />city_state: San Antonio, TX<br />estimate: 0.4285714","conf_low: 0.5576628<br />conf_high: 0.6753422<br />city_state: San Bernardino, CA<br />estimate: 0.6181818","conf_low: 0.3354259<br />conf_high: 0.4258315<br />city_state: San Diego, CA<br />estimate: 0.3796095","conf_low: 0.4680516<br />conf_high: 0.5454433<br />city_state: San Francisco, CA<br />estimate: 0.5067873","conf_low: 0.4041252<br />conf_high: 0.5318665<br />city_state: Savannah, GA<br />estimate: 0.4674797","conf_low: 0.5154369<br />conf_high: 0.5636879<br />city_state: St. Louis, MO<br />estimate: 0.5396541","conf_low: 0.5517145<br />conf_high: 0.6447418<br />city_state: Stockton, CA<br />estimate: 0.5990991","conf_low: 0.3881009<br />conf_high: 0.5269851<br />city_state: Tampa, FL<br />estimate: 0.4567308","conf_low: 0.2932349<br />conf_high: 0.3711192<br />city_state: Tulsa, OK<br />estimate: 0.3310463","conf_low: 0.4112495<br />conf_high: 0.4649455<br />city_state: Washington, DC<br />estimate: 0.4379182"],"type":"scatter","mode":"lines","opacity":1,"line":{"color":"transparent"},"error_y":{"array":[0.0513332203121349,0.031471421466469,0.0175991953857436,0.0487598090753998,0.0352057481890362,0.0402020582872963,0.0418038701556435,0.0360454212754139,0.0115370953463946,0.0378989238466023,0.0300077496410138,0.0250733264401792,0.0560140812049631,0.0192666302441059,0.0601516171371205,0.0427310081123972,0.0443737157320374,0.0182135316401225,0.0273014399481592,0.0290100839540223,0.0286020589472369,0.0265468594046689,0.0515989217748125,0.0208444246080254,0.0416984501537965,0.0242466749945465,0.0351627794666202,0.029084400766021,0.0521809217099031,0.0352890348843428,0.0246259396975098,0.039515664613444,0.0320728204813689,0.0385054524259892,0.04954480707971,0.0179054011582327,0.0325020904978442,0.0393815756249488,0.0448625122846903,0.0512322828077911,0.0344616757408758,0.0571604049325292,0.0462219637333801,0.0386559764502041,0.064386864249817,0.0240337150951984,0.0456426843504824,0.0702543382629305,0.0400728556125307,0.0270272563335275],"arrayminus":[0.0489830019891024,0.0305385654508512,0.0179982073532744,0.0480654090830896,0.0345610513678333,0.040264063285038,0.0434851044636604,0.0337724577093105,0.0118668035347985,0.0372843825516465,0.0302260850930621,0.0249800642048432,0.0570568311269721,0.0195383974378104,0.0563546582400418,0.0422266554994513,0.0419213323212632,0.0182332177884478,0.0270036211641085,0.0290841441036856,0.0280037388185234,0.0260641865042308,0.0497957799679844,0.0208101838569787,0.0410641370881935,0.0233177469824389,0.036260384849531,0.0281177921814441,0.0524139797067814,0.0338918964431904,0.0254308027921958,0.0381177292046533,0.0323720697272768,0.0383329653242729,0.0478883462447013,0.0177723132771375,0.0329398155530007,0.0398022988234937,0.0405461727061044,0.0485249141225581,0.0337942152287431,0.0605190215782221,0.0441836421868846,0.0387357208926188,0.06335447823736,0.0242172320526221,0.0473845838859014,0.0686298662091133,0.0378114392841835,0.0266686916411842],"type":"data","width":3.01195219123506,"symmetric":false,"color":"rgba(0,0,0,1)"},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":39.1199667911997,"l":43.1050228310502},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,50.6],"tickmode":"array","ticktext":["Richmond, VA","Charlotte, NC","Memphis, TN","Tulsa, OK","Fresno, CA","Milwaukee, wI","Nashville, TN","Durham, NC","Sacramento, CA","San Diego, CA","Atlanta, GA","Albuquerque, NM","New York, NY","Kansas City, MO","Long Beach, CA","Omaha, NE","Las Vegas, NV","San Antonio, TX","Birmingham, AL","Washington, DC","Cincinnati, OH","Philadelphia, PA","Indianapolis, IN","Louisville, KY","Tampa, FL","Baton Rouge, LA","Fort Worth, TX","Savannah, GA","Dallas, TX","Oklahoma City, OK","Los Angeles, CA","Boston, MA","San Francisco, CA","Houston, TX","Minneapolis, MN","Jacksonville, FL","Columbus, OH","Pittsburgh, PA","Oakland, CA","St. Louis, MO","Denver, CO","Phoenix, AZ","Detroit, MI","Stockton, CA","Miami, FL","Buffalo, NY","San Bernardino, CA","Baltimore, MD","New Orleans, LA","Chicago, IL"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"categoryorder":"array","categoryarray":["Richmond, VA","Charlotte, NC","Memphis, TN","Tulsa, OK","Fresno, CA","Milwaukee, wI","Nashville, TN","Durham, NC","Sacramento, CA","San Diego, CA","Atlanta, GA","Albuquerque, NM","New York, NY","Kansas City, MO","Long Beach, CA","Omaha, NE","Las Vegas, NV","San Antonio, TX","Birmingham, AL","Washington, DC","Cincinnati, OH","Philadelphia, PA","Indianapolis, IN","Louisville, KY","Tampa, FL","Baton Rouge, LA","Fort Worth, TX","Savannah, GA","Dallas, TX","Oklahoma City, OK","Los Angeles, CA","Boston, MA","San Francisco, CA","Houston, TX","Minneapolis, MN","Jacksonville, FL","Columbus, OH","Pittsburgh, PA","Oakland, CA","St. Louis, MO","Denver, CO","Phoenix, AZ","Detroit, MI","Stockton, CA","Miami, FL","Buffalo, NY","San Bernardino, CA","Baltimore, MD","New Orleans, LA","Chicago, IL"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":10.6268161062682},"tickangle":-80,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"City, State","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.196629955866685,0.773626922137122],"tickmode":"array","ticktext":["0.2","0.3","0.4","0.5","0.6","0.7"],"tickvals":[0.2,0.3,0.4,0.5,0.6,0.7],"categoryorder":"array","categoryarray":["0.2","0.3","0.4","0.5","0.6","0.7"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"Proportion (95% Confidence interval)","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"source":"A","attrs":{"6c0b55d815e3":{"x":{},"y":{},"type":"scatter"},"6c0b5d85161c":{"ymin":{},"ymax":{},"x":{},"y":{}}},"cur_data":"6c0b55d815e3","visdat":{"6c0b55d815e3":["function (y) ","x"],"6c0b5d85161c":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
</div>
<div id="further-analysis" class="section level4">
<h4>Further analysis</h4>
<p>In the code chunk below, I am reading in the dataset and creating a city_state variable (e.g. “Baltimore, MD”), and a binary variable indicating whether the homicide is solved. I will also remove Dallas, TX; Phoenix, AZ; and Kansas City, MO – these don’t report victim race and then Tulsa, AL – this is a data entry mistake.</p>
<p>I will then modify victim_race to have categories white and non-white, with white as the reference category and make victim_age numeric.</p>
<pre class="r"><code>homicide_df = read_csv(&quot;https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv&quot;, col_names = TRUE) %&gt;% 
  mutate(city_state = str_c(city, &quot;,&quot;, &quot; &quot;, state),
         solved = if_else(disposition == &quot;Closed by arrest&quot;, &quot;resolved&quot;, &quot;unresolved&quot;),
         solved = fct_relevel(solved, &quot;unresolved&quot;),
         victim_race = tolower(victim_race),
         colpsd_victim_race = fct_collapse(victim_race, &quot;non-white&quot; = c(&quot;asian&quot;,&quot;black&quot;, &quot;hispanic&quot;, &quot;other&quot;, &quot;unknown&quot;)),
         colpsd_victim_race = fct_relevel(colpsd_victim_race, &quot;white&quot;),
         victim_age = as.numeric(victim_age)) %&gt;% 
  filter(!(city_state %in% c(&quot;Dallas, TX&quot;, &quot;Phoenix, AZ&quot;, &quot;Kansas City, MO&quot;, &quot;Tulsa, AL&quot;)))</code></pre>
<pre><code>## Warning in evalq(as.numeric(victim_age), &lt;environment&gt;): NAs introduced by
## coercion</code></pre>
<p>For the city of Baltimore, MD, I will use glm function to fit a logistic regression with resolved vs unresolved as the outcome and victim age, sex and race as predictors. Subsequently, I will obtain the estimate and confidence interval of the adjusted odds ratio for solving homicides comparing non-white victims to white victims keeping all other variables fixed.</p>
<pre class="r"><code>baltimore_df = homicide_df %&gt;% 
  filter(city_state == &quot;Baltimore, MD&quot;)
fit_logistic_baltimore = glm(solved ~ victim_age + victim_sex + colpsd_victim_race, data = baltimore_df, family = binomial())
fit_logistic_baltimore %&gt;% broom::tidy() %&gt;% 
  janitor::clean_names() %&gt;% 
  mutate(OR = exp(estimate),
         lower_95_ci = exp(estimate - (1.96 * std_error)),
         upper_95_ci = exp(estimate + (1.96 * std_error))) %&gt;% 
  filter(term == &quot;colpsd_victim_racenon-white&quot;) %&gt;% 
  select(OR, lower_95_ci, upper_95_ci) %&gt;% 
  knitr::kable(digits = 3)</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">OR</th>
<th align="right">lower_95_ci</th>
<th align="right">upper_95_ci</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.441</td>
<td align="right">0.313</td>
<td align="right">0.62</td>
</tr>
</tbody>
</table>
<p>The odds of solving homicides comparing non-white victimes to white victims, adjusting for sex and age is 0.44 (95% CI: 0.31, 0.62).</p>
<p>Now, I will run <code>glm</code> for each of the cities in the dataset, each time extracting the adjusted odds ratio (and CI) for solving homicides comparing non-white victims to white victims.</p>
<pre class="r"><code>fit_logistic_cities = homicide_df %&gt;% 
  #Selecting only the variables needed
  select(city_state, solved, victim_age, victim_sex, colpsd_victim_race) %&gt;%
  #Making listcolumns to use for the iteration
  group_by(city_state) %&gt;% 
  nest() %&gt;% 
  #Using maps to iterate the glm and tidy functions
  mutate(models = map(.x = data, ~ glm(solved ~ victim_sex + colpsd_victim_race + victim_age, 
                                      family = binomial, data = .x)),
         models = map(models, broom::tidy)) %&gt;% 
  select(-data) %&gt;% unnest() %&gt;% 
  filter(term == &quot;colpsd_victim_racenon-white&quot;) %&gt;% 
  mutate(OR = exp(estimate),
  # Calculating the 95% confidence intervals
         lower_95_ci = exp(estimate - (1.96*std.error)),
         upper_95_ci = exp(estimate + (1.96*std.error))) %&gt;% 
  select(city_state, OR, lower_95_ci, upper_95_ci) %&gt;% 
  #Organizing cities according to estimated OR. From lowest to highest
  mutate(city_state = reorder(city_state, OR))</code></pre>
<p>Creating a plot that shows the estimated ORs and CIs for each city.</p>
<pre class="r"><code>ggplot(fit_logistic_cities, aes(x = city_state, y = OR )) + 
  geom_point() + 
  geom_errorbar(aes(ymin = lower_95_ci, ymax = upper_95_ci)) + 
  coord_flip() +
  geom_hline(aes(yintercept = 1.00), linetype = &quot;dashed&quot;, color = &quot;blue&quot;) + 
  labs(
    y = &quot;OR (95% Confidence interval)&quot;,
    x = &quot;City, State&quot;
  ) </code></pre>
<p><img src="unsolved_homicide_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>We see that in almost all the cities ( expections, Tampa &amp; Birmingham and Durham) have OR below 1.0. This means that in almost all of the cities, the odds of solving a homicide for non-white is less that white category, adjusting for sex and age. However, it is important to note the confidence intervals - about half include the value of 1, meaning they are not statistically significant.</p>
</div>

<br><br>
<footer>
   <br>
  <p class="copyright text-muted" align="center">Copyright &copy; 2018 Amin Yakubu</p>
</footer>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
